<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>考试系统</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #6b8cbc;
            --success: #4caf50;
            --danger: #f44336;
            --light: #f8f9fa;
            --dark: #343a40;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        h1 {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 1rem;
        }
        
        .section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--secondary);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        input[type="number"], 
        select {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input[type="number"]:focus, 
        select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
        }
        
        .subjects-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        
        .subject-item {
            background: var(--light);
            padding: 10px 15px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .subject-item:hover {
            background: #e9ecef;
        }
        
        .subject-item input {
            margin-right: 10px;
        }
        
        .btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .hidden {
            display: none;
        }
        
        .exam-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }
        
        .exam-info {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .timer {
            font-size: 1.2rem;
            background: var(--dark);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
        }
        
        .question-container {
            margin-bottom: 2rem;
        }
        
        .question {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            font-weight: 500;
        }
        
        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .option {
            padding: 1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option:hover {
            background: #f1f7ff;
            border-color: var(--primary);
        }
        
        .option.selected {
            background: #e3f2fd;
            border-color: var(--primary);
        }
        
        .result-summary {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .score {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
            margin: 1rem 0;
        }
        
        .results-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .result-section {
            padding: 1.5rem;
            border-radius: 10px;
        }
        
        .correct-section {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid var(--success);
        }
        
        .incorrect-section {
            background: rgba(244, 67, 54, 0.1);
            border: 1px solid var(--danger);
        }
        
        .result-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .question-result {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .question-text {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .answer {
            padding: 0.5rem;
            border-radius: 5px;
            margin: 0.5rem 0;
        }
        
        .correct-answer {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid var(--success);
        }
        
        .incorrect-answer {
            background: rgba(244, 67, 54, 0.2);
            border-left: 4px solid var(--danger);
        }
        
        .explanation {
            padding: 0.8rem;
            background: #f8f9fa;
            border-radius: 5px;
            margin-top: 0.8rem;
            font-style: italic;
        }
        
        .progress-container {
            margin: 1.5rem 0;
            background: #e9ecef;
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            transition: width 0.4s ease;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .results-container {
                grid-template-columns: 1fr;
            }
            
            .exam-header {
                flex-direction: column;
                gap: 1rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 欢迎页面 -->
        <header>
            <h1>考试系统</h1>
            <p class="text-center">选择科目和题目数量开始考试</p>
        </header>
        
        <!-- 科目选择部分 -->
        <section id="subject-selection" class="section">
            <h2 class="section-title">选择考试科目</h2>
            
            <div class="form-group">
                <label for="question-count">题目数量</label>
                <input type="number" id="question-count" min="1" max="50" value="5">
            </div>
            
            <div class="form-group">
                <label>选择科目</label>
                <div class="controls">
                    <button id="select-all" class="btn">全选</button>
                    <button id="deselect-all" class="btn">取消全选</button>
                </div>
                <div id="subjects-container" class="subjects-container">
                    <!-- 科目列表将通过JavaScript动态生成 -->
                </div>
            </div>
            
            <button id="start-exam" class="btn btn-block">开始考试</button>
        </section>
        
        <!-- 考试界面 -->
        <section id="exam-section" class="section hidden">
            <div class="exam-header">
                <div class="exam-info">
                    <span id="current-subject">科目：</span>
                    <span id="progress">题目：1/5</span>
                </div>
                <div class="timer" id="timer">00:00</div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
            </div>
            
            <div class="question-container">
                <div class="question" id="question-text"></div>
                <div class="options-container" id="options-container">
                    <!-- 选项将通过JavaScript动态生成 -->
                </div>
            </div>
            
            <div class="controls">
                <button id="prev-question" class="btn">上一题</button>
                <button id="next-question" class="btn">下一题</button>
                <button id="submit-exam" class="btn btn-success">提交试卷</button>
            </div>
        </section>
        
        <!-- 结果页面 -->
        <section id="result-section" class="section hidden">
            <div class="result-summary">
                <h2 class="section-title">考试结果</h2>
                <div class="score" id="score">0/0</div>
                <p>正确率: <span id="accuracy">0</span>%</p>
            </div>
            
            <div class="results-container">
                <div class="result-section correct-section">
                    <h3 class="result-title">答对的题目 (<span id="correct-count">0</span>)</h3>
                    <div id="correct-questions">
                        <!-- 正确题目将通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <div class="result-section incorrect-section">
                    <h3 class="result-title">答错的题目 (<span id="incorrect-count">0</span>)</h3>
                    <div id="incorrect-questions">
                        <!-- 错误题目将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button id="review-exam" class="btn">复习错题</button>
                <button id="new-exam" class="btn btn-block">开始新考试</button>
            </div>
        </section>
        
        <!-- 加载状态 -->
        <section id="loading-section" class="section hidden">
            <div class="loading">
                <div class="spinner"></div>
                <p>正在加载考试数据，请稍候...</p>
            </div>
        </section>
    </div>

    <script>
        // 全局变量
        const state = {
            subjects: [],          // 所有科目数据
            selectedSubjects: [],   // 用户选择的科目
            questionCount: 5,       // 题目数量
            examQuestions: [],      // 本次考试的题目
            currentQuestion: 0,     // 当前题目索引
            userAnswers: [],        // 用户答案
            startTime: null,        // 考试开始时间
            timerInterval: null,    // 计时器
            questionHistory: {}     // 题目历史记录
        };

        // DOM元素
        const elements = {
            subjectSelection: document.getElementById('subject-selection'),
            examSection: document.getElementById('exam-section'),
            resultSection: document.getElementById('result-section'),
            loadingSection: document.getElementById('loading-section'),
            subjectsContainer: document.getElementById('subjects-container'),
            questionCount: document.getElementById('question-count'),
            startExamBtn: document.getElementById('start-exam'),
            questionText: document.getElementById('question-text'),
            optionsContainer: document.getElementById('options-container'),
            prevQuestionBtn: document.getElementById('prev-question'),
            nextQuestionBtn: document.getElementById('next-question'),
            submitExamBtn: document.getElementById('submit-exam'),
            progress: document.getElementById('progress'),
            progressBar: document.getElementById('progress-bar'),
            timer: document.getElementById('timer'),
            currentSubject: document.getElementById('current-subject'),
            score: document.getElementById('score'),
            accuracy: document.getElementById('accuracy'),
            correctCount: document.getElementById('correct-count'),
            incorrectCount: document.getElementById('incorrect-count'),
            correctQuestions: document.getElementById('correct-questions'),
            incorrectQuestions: document.getElementById('incorrect-questions'),
            reviewExamBtn: document.getElementById('review-exam'),
            newExamBtn: document.getElementById('new-exam'),
            selectAllBtn: document.getElementById('select-all'),
            deselectAllBtn: document.getElementById('deselect-all')
        };

        // 初始化函数
        function init() {
            // 加载题目历史记录
            loadQuestionHistory();
            
            // 加载科目数据
            loadSubjects();
            
            // 设置事件监听器
            setupEventListeners();
        }

        // 加载科目数据
        async function loadSubjects() {
            showLoading();
            
            let index = 1;
            const subjects = [];
            
            while (true) {
                const filename = `subjects/${index.toString().padStart(4, '0')}.json`;
                
                try {
                    const response = await fetch(filename);
                    if (!response.ok) break;
                    
                    const subjectData = await response.json();
                    subjects.push({
                        id: index,
                        name: subjectData.subjectName,
                        questions: subjectData.questions
                    });
                    
                    index++;
                } catch (error) {
                    console.error(`加载科目文件失败: ${filename}`, error);
                    break;
                }
            }
            
            state.subjects = subjects;
            renderSubjectSelection();
            hideLoading();
        }

        // 渲染科目选择界面
        function renderSubjectSelection() {
            elements.subjectsContainer.innerHTML = '';
            
            state.subjects.forEach(subject => {
                const subjectElement = document.createElement('div');
                subjectElement.className = 'subject-item';
                subjectElement.innerHTML = `
                    <input type="checkbox" id="subject-${subject.id}" value="${subject.id}" checked>
                    <label for="subject-${subject.id}">${subject.name}</label>
                `;
                elements.subjectsContainer.appendChild(subjectElement);
            });
            
            // 默认全选
            state.selectedSubjects = state.subjects.map(subject => subject.id);
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 开始考试按钮
            elements.startExamBtn.addEventListener('click', startExam);
            
            // 上一题按钮
            elements.prevQuestionBtn.addEventListener('click', () => navigateQuestion(-1));
            
            // 下一题按钮
            elements.nextQuestionBtn.addEventListener('click', () => navigateQuestion(1));
            
            // 提交试卷按钮
            elements.submitExamBtn.addEventListener('click', submitExam);
            
            // 开始新考试按钮
            elements.newExamBtn.addEventListener('click', () => {
                elements.resultSection.classList.add('hidden');
                elements.subjectSelection.classList.remove('hidden');
            });
            
            // 复习错题按钮
            elements.reviewExamBtn.addEventListener('click', reviewIncorrectQuestions);
            
            // 全选按钮
            elements.selectAllBtn.addEventListener('click', () => {
                document.querySelectorAll('#subjects-container input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = true;
                });
                state.selectedSubjects = state.subjects.map(subject => subject.id);
            });
            
            // 取消全选按钮
            elements.deselectAllBtn.addEventListener('click', () => {
                document.querySelectorAll('#subjects-container input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
                state.selectedSubjects = [];
            });
            
            // 科目选择变化
            elements.subjectsContainer.addEventListener('change', (e) => {
                if (e.target.type === 'checkbox') {
                    const subjectId = parseInt(e.target.value);
                    if (e.target.checked) {
                        if (!state.selectedSubjects.includes(subjectId)) {
                            state.selectedSubjects.push(subjectId);
                        }
                    } else {
                        state.selectedSubjects = state.selectedSubjects.filter(id => id !== subjectId);
                    }
                }
            });
            
            // 题目数量变化
            elements.questionCount.addEventListener('change', (e) => {
                state.questionCount = Math.max(1, Math.min(50, parseInt(e.target.value) || 5));
                e.target.value = state.questionCount;
            });
        }

        // 开始考试
        async function startExam() {
            if (state.selectedSubjects.length === 0) {
                alert('请至少选择一个科目');
                return;
            }
            
            state.questionCount = parseInt(elements.questionCount.value) || 5;
            
            // 获取所有题目
            const allQuestions = [];
            state.subjects
                .filter(subject => state.selectedSubjects.includes(subject.id))
                .forEach(subject => {
                    subject.questions.forEach(question => {
                        allQuestions.push({
                            ...question,
                            subjectId: subject.id,
                            subjectName: subject.name
                        });
                    });
                });
            
            if (allQuestions.length === 0) {
                alert('所选科目中没有题目');
                return;
            }
            
            // 智能选题算法（避免近期答对题目）
            state.examQuestions = selectExamQuestions(allQuestions);
            
            if (state.examQuestions.length === 0) {
                alert('没有符合筛选条件的题目');
                return;
            }
            
            // 重置考试状态
            state.currentQuestion = 0;
            state.userAnswers = new Array(state.examQuestions.length).fill(null);
            state.startTime = new Date();
            
            // 开始计时
            startTimer();
            
            // 显示考试界面
            elements.subjectSelection.classList.add('hidden');
            elements.examSection.classList.remove('hidden');
            
            // 显示第一题
            renderQuestion();
        }

        // 智能选题算法
        function selectExamQuestions(allQuestions) {
            const now = Date.now();
            const thirtyDays = 30 * 24 * 60 * 60 * 1000; // 30天的毫秒数
            
            // 对题目进行评分：从未答过 > 答错 > 很久以前答对 > 最近答对
            const scoredQuestions = allQuestions.map(question => {
                const history = state.questionHistory[question.id];
                
                if (!history) {
                    return { ...question, score: 100 }; // 从未答过，最高优先级
                }
                
                if (!history.correct) {
                    return { ...question, score: 80 }; // 曾经答错，高优先级
                }
                
                const timeSinceLast = now - history.lastAnswered;
                if (timeSinceLast > thirtyDays) {
                    // 很久以前答对，中等优先级（越久优先级越高）
                    const monthsPassed = Math.floor(timeSinceLast / thirtyDays);
                    return { ...question, score: Math.min(60, 30 + monthsPassed * 10) };
                }
                
                // 最近答对，低优先级
                return { ...question, score: 10 };
            });
            
            // 按分数降序排序
            scoredQuestions.sort((a, b) => b.score - a.score);
            
            // 选择前N个题目
            return scoredQuestions
                .slice(0, Math.min(state.questionCount, scoredQuestions.length))
                .map(q => ({
                    id: q.id,
                    question: q.question,
                    options: q.options,
                    correctAnswer: q.correctAnswer,
                    explanation: q.explanation,
                    subjectId: q.subjectId,
                    subjectName: q.subjectName
                }));
        }

        // 渲染题目
        function renderQuestion() {
            const question = state.examQuestions[state.currentQuestion];
            
            // 更新题目信息
            elements.questionText.textContent = question.question;
            elements.currentSubject.textContent = `科目：${question.subjectName}`;
            elements.progress.textContent = `题目：${state.currentQuestion + 1}/${state.examQuestions.length}`;
            
            // 更新进度条
            const progressPercent = ((state.currentQuestion + 1) / state.examQuestions.length) * 100;
            elements.progressBar.style.width = `${progressPercent}%`;
            
            // 渲染选项
            elements.optionsContainer.innerHTML = '';
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (state.userAnswers[state.currentQuestion] === index) {
                    optionElement.classList.add('selected');
                }
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionElement.dataset.index = index;
                
                optionElement.addEventListener('click', () => {
                    // 移除所有选项的选中状态
                    document.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // 设置当前选项为选中状态
                    optionElement.classList.add('selected');
                    
                    // 保存用户答案
                    state.userAnswers[state.currentQuestion] = index;
                });
                
                elements.optionsContainer.appendChild(optionElement);
            });
            
            // 更新导航按钮状态
            elements.prevQuestionBtn.disabled = state.currentQuestion === 0;
            elements.nextQuestionBtn.disabled = state.currentQuestion === state.examQuestions.length - 1;
        }

        // 导航题目
        function navigateQuestion(direction) {
            const newIndex = state.currentQuestion + direction;
            if (newIndex >= 0 && newIndex < state.examQuestions.length) {
                state.currentQuestion = newIndex;
                renderQuestion();
            }
        }

        // 开始计时器
        function startTimer() {
            let seconds = 0;
            
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
            }
            
            state.timerInterval = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                elements.timer.textContent = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // 提交试卷
        function submitExam() {
            // 检查是否所有题目都已作答
            const unanswered = state.userAnswers.some(answer => answer === null);
            if (unanswered) {
                if (!confirm('还有题目未作答，确定要提交吗？')) {
                    return;
                }
            }
            
            // 停止计时器
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
                state.timerInterval = null;
            }
            
            // 计算分数
            const correctAnswers = state.examQuestions.reduce((count, question, index) => {
                return count + (state.userAnswers[index] === question.correctAnswer ? 1 : 0);
            }, 0);
            
            // 更新题目历史记录
            updateQuestionHistory(correctAnswers);
            
            // 显示结果
            showResults(correctAnswers);
        }

        // 更新题目历史记录
        function updateQuestionHistory(correctCount) {
            const now = Date.now();
            
            state.examQuestions.forEach((question, index) => {
                const isCorrect = state.userAnswers[index] === question.correctAnswer;
                
                if (!state.questionHistory[question.id]) {
                    state.questionHistory[question.id] = {
                        correct: isCorrect,
                        lastAnswered: now,
                        answerCount: 1,
                        correctCount: isCorrect ? 1 : 0
                    };
                } else {
                    const history = state.questionHistory[question.id];
                    history.correct = isCorrect;
                    history.lastAnswered = now;
                    history.answerCount++;
                    if (isCorrect) {
                        history.correctCount++;
                    }
                }
            });
            
            // 保存到localStorage
            localStorage.setItem('questionHistory', JSON.stringify(state.questionHistory));
        }

        // 显示考试结果
        function showResults(correctCount) {
            const totalQuestions = state.examQuestions.length;
            const accuracy = Math.round((correctCount / totalQuestions) * 100);
            
            // 更新结果统计
            elements.score.textContent = `${correctCount}/${totalQuestions}`;
            elements.accuracy.textContent = accuracy;
            elements.correctCount.textContent = correctCount;
            elements.incorrectCount.textContent = totalQuestions - correctCount;
            
            // 渲染正确题目
            elements.correctQuestions.innerHTML = '';
            state.examQuestions.forEach((question, index) => {
                if (state.userAnswers[index] === question.correctAnswer) {
                    renderQuestionResult(question, index, elements.correctQuestions, true);
                }
            });
            
            // 渲染错误题目
            elements.incorrectQuestions.innerHTML = '';
            state.examQuestions.forEach((question, index) => {
                if (state.userAnswers[index] !== question.correctAnswer) {
                    renderQuestionResult(question, index, elements.incorrectQuestions, false);
                }
            });
            
            // 显示结果界面
            elements.examSection.classList.add('hidden');
            elements.resultSection.classList.remove('hidden');
        }

        // 渲染题目结果
        function renderQuestionResult(question, index, container, isCorrect) {
            const userAnswer = state.userAnswers[index];
            const correctAnswer = question.correctAnswer;
            
            const resultElement = document.createElement('div');
            resultElement.className = 'question-result';
            resultElement.innerHTML = `
                <div class="question-text">${index + 1}. ${question.question}</div>
                <div class="answer ${isCorrect ? 'correct-answer' : 'incorrect-answer'}">
                    <strong>你的答案:</strong> ${String.fromCharCode(65 + userAnswer)}. ${question.options[userAnswer]}
                    ${!isCorrect ? `<br><strong>正确答案:</strong> ${String.fromCharCode(65 + correctAnswer)}. ${question.options[correctAnswer]}` : ''}
                </div>
                <div class="explanation">
                    <strong>解析:</strong> ${question.explanation}
                </div>
            `;
            
            container.appendChild(resultElement);
        }

        // 复习错题
        function reviewIncorrectQuestions() {
            // 收集所有错题
            const incorrectQuestions = state.examQuestions.filter((question, index) => {
                return state.userAnswers[index] !== question.correctAnswer;
            });
            
            if (incorrectQuestions.length === 0) {
                alert('没有错题可以复习');
                return;
            }
            
            // 设置考试题目为错题
            state.examQuestions = incorrectQuestions;
            state.currentQuestion = 0;
            state.userAnswers = new Array(incorrectQuestions.length).fill(null);
            state.startTime = new Date();
            
            // 开始计时
            startTimer();
            
            // 显示考试界面
            elements.resultSection.classList.add('hidden');
            elements.examSection.classList.remove('hidden');
            
            // 显示第一题
            renderQuestion();
        }

        // 加载题目历史记录
        function loadQuestionHistory() {
            const savedHistory = localStorage.getItem('questionHistory');
            if (savedHistory) {
                state.questionHistory = JSON.parse(savedHistory);
            }
        }

        // 显示加载状态
        function showLoading() {
            elements.loadingSection.classList.remove('hidden');
        }

        // 隐藏加载状态
        function hideLoading() {
            elements.loadingSection.classList.add('hidden');
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
